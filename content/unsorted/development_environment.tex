%!TEX root = ../../super_main.tex

\section{Development Environment}
\label{sec:development_environment}

% Uniform environment for easier knowledge sharing
%  - Android Studio
%   - code/checkstyle
%  - Phpstorm
%  - Laravel
%  - Bootstrap
%  - Jenkins
%  - Postgres

% Skriv om ovenstÃ¥ende her.
 

% Test
%  - Unit test
%   - Sensor data hard to mock
%  - Instrumental test 
%   - While developing -> own phones
%   - CI also requires phone
%   - Android fragmentation
%   - New OS
%    - Rooting
%    - Problems 
%    - Galaxy nexus 4.3 -> 5.0
%   - Migrating robolectric tests to instrumental

Because of the desire to conduct test-driven development, it was necessary to set up a testing procedure. We decided to use JUnit during the Android development and PHPUnit for the web development part. We additionally utilized the Robolectric framework, which allows for mocking of Android \emph{Activity} objects and general Android behavior from the native environment. This allows very coupled Android components to be tested seperately and without the use of an emulator. 
\\\\
That worked until we started using sensors during the development, because neither the JUnit framework nor the Robolectric framework facilitate mocked sensor events. Sensor events were an important part of the solution we had in mind, and we therefore decided to start using instrumental tests, which requires an actual running Android device. This could easily be facilitated during the development by using our own Android cellphones, but for the purpose of Continuous Integration and Jenkins builds, the server also needed access to a running device. We could not use our own phones, because the server had to be located in the basement of the institute in order to have access from outside the university's network. The CI server also had to function as storage for the sensor data we gathered from mobile devices, and it therefore had to be accessible from the Internet in general.
\\\\
The mobile telephones we could borrow from the university were old devices running Android version 4.3 or lower, which correspond to Android API level 18, also known as JELLY\_BEAN\_MR2 \parencite{uses_sdk}. We felt that these versions of android were too unused \parencite{android_dashboard}, and that newer editions improved and provided too many new features, which we could not ignore. An example of this is the Android wearables API which was introduced in Android version 4.4W (API 20), the wearables-extension to android API 19, KITKAT. API level 19 was furthermore released about three years ago, and many devices will probably start failing, have bad battery times, etc. and therefore be replaced within reasonably short time. We therefore came to the realization that we needed to have API level 20 or higher. This meant that in order to use the devices we could borrow, we had to root them and flash a new OS onto them. The devices we could borrow were the Galaxy S3 mini ve (i8200) and the Galaxy S3 mini (i8190). We spent a couple of days on researching and attempting root the two S3 devices, but the i8200 did not have any ROMs available from trustworthy sites, and the i8190 would enter a boot-loop when we flashed it. So both phones were reset to factory settings and returned. After this we got our hands on a galaxy nexus, for which the Android community has made a lot of high quality ROMs and guides for flashing. We managed to flash the nexus to 5.0 (API 21), which allowed us to connect it to the CI server and run instrument tests. We therefore decided to migrate all of our old Robolectric tests to instrumentation tests, such that we only had a single type of tests. Due to the phones we had access to, the usefulness of higher API levels, we ultimately decided to use API 21 as our target version. 