%!TEX root = ../../../super_main.tex
\subsection{Server Interface}
\label{sub:server_interface}
The interface from the clients to the server also needs to be considered. We chose to follow the REST principles \todo{ref til tidligere rapport eller web guys phd thesis} and implement a RESTful API. This contributes to our architectures ability to handle an increasing amount of clients. The REST principles involves having a uniform interface from the perspective of all devices regardless of how we choose to expand the capacity of the back end. This means that we can add sophisticated tools to handle load balancing and caching for web APIs and applications such as Varnish \footnote{https://www.varnish-cache.org/} and HAProxy \footnote{http://www.haproxy.org/} to allow us to serve more users, without changing anything on the client side. Such technologies both help scaling out to many servers, by balancing work to all available server instances, and scaling up by providing better performance on individual machines through caching. This effectively means that we can reduce the problem of scalability to implementing a proper Restful interface. 
\\\\
The communication between the server and the client will be done over HTTP, and we will ensure that each resource, e.g. a campaign or a snapshot, will have a Unique Resource Identifier (URI). In our system we have need for storing three different kinds of resources on our server, namely campaigns, snapshots, and participants. The main object in our system is the campaign, and each other object will only exist in the system if it is somehow linked to a campaign, meaning that it makes sense to form the URI for these associated items as a part of a campaign. 

\tabref{tab:api_routes} shows the routes of the system that have something to do with retrieving campaign information (the first two routes), and joining and uploading snapshots (the last two routes). As seen in \tabref{tab:api_routes} all of these routes is prefixed with ``api'' which is used to indicate that these routes will return a response in JSON-format. As mentioned the first two routes are used for retrieving information about campaigns, hence they are of the request type GET. The \mono{api/campaigns} - route is requested from the device to return a list of identifiers, names and authors for all publicly available campaigns. The identifier from the request can be used using the \mono{api/campaigns/\{identifier\}}-route, which return all the specifications of a given campaign provided an identifier. For instance the route \mono{api/campaigns/5} would return a JSON response containing all details about the campaign with id 5. The last two routes are of the POST type which means they are used to upload some information to the server. The two scenarios for these are joining (\mono{api/campaigns/\{identifier\}/participants}) a campaign and uploading snapshots (\mono{api/campaigns/{identifier}/snapshots}). Note that in both of these \mono{POST} requests an identifier for the device of the participant is sent in the body of the request, in order to know who are joining or uploading information.
\\\\
\begin{table}[!htbp]
    \centering
    \begin{tabular}{|l|l|} 
        \hline
        \textbf{Type} & \textbf{URI}                                  \\ \hline 
        \mono{GET }   & \mono{api/campaigns}                          \\ \hline 
        \mono{GET }   & \mono{api/campaigns/\{identifier\}}           \\ \hline 
        \mono{POST}   & \mono{api/campaigns/{identifier}/participants}\\ \hline 
        \mono{POST}   & \mono{api/campaigns/\{identifier\}/snapshots} \\ \hline 
    \end{tabular}
    \caption{The routes that the client uses to send and get information to and from the server.}
    \label{tab:api_routes}
\end{table}

Besides the routes for the Android client we have also created some for the web application that the customers would use. These routes are not prefixed with ``api'', and are used for creating and managing the campaigns in the system and retrieve information about the campaigns and their submitted snapshots. These routes are described in \secref{sec:customer_interaction}. 