%!TEX root = ../../super_main.tex

\section{Client Application}
\label{sec:client_application}

The device component is the part of the system that should run directly on the smartphone of the participant. This component is responsible for interacting with the participants, gather data from the sensors on the device, and communicating with the other devices in order to get data from wearables. The sensors represent the underlying hardware, and the Wearable Application is the interface from the client application to external wearable sensors, which in our case is the Microsoft Health application that communicates with Microsoft Band 2 we have implemented support for in the system.
\\\\
The smartphone application contains a service component that is the main controller of the client application. This service runs independently in the background at all times, and is the part of the system on a device that communicates with the different sensor providers, and also uploads the collected snapshots to the server. Furthermore it is also responsible for prompting the participants to answer the questionnaires. This service is completely detached from the graphical interface and it runs in its own seperate process, since it needs to be responsive to changes read by sensors and in other data sources. This seperation is furthermore beneficial, because it allows the Android OS to properly close and free the UI components when they are not used and deallocate all memory used by them. 
\\\\
The UI components consists of two interfaces, a settings interface and a questionnaire interface. The settings interface allows for the participant to browse details and join campaigns. Furthermore, it also has some communication with the web server where it fetches the specifications of campaigns, and reports back to the server which campaigns the participants has joined. The questionnaire interface is a series of user inputs where the participants can provide answers for the questions of a questionnaire. This interface is prompted to the user by using notifications, which are sent by the service for every snapshot, in order to obtain labels on the data if possible.
\\\\
The service component is also in need of some persistent storage on the device, to ensure that it can store gathered snapshots, so that it can upload the data using best practices in regards of power consumption and robustness as described in \secref{sec:general_strategies}. For this reason the application has a storage module where we utilize a library called \mono{realm}, which will be further describe in \secref{sub:local_storage}.
\\\\
Lastly the service component is heavily dependent on the sensor providers, which are providers that abstracts various types of sensors, for example hardware sensors on the device, software sensors, and external sensors from wearable and so on. From the service point of view, it only needs to manage the specification of campaigns and request the data from these providers accordingly before it stores the data that has been gathered from these providers on the device. The controller of the service assumes that the interface of these providers guarantees the amount of data requested and that they keep their deadlines in regards to timing of measurements.

\input{content/architecture/client_server_communication/client_request}
